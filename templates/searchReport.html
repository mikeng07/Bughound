<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='style.css')}}">
    <title>Bug Lookup/Edit</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
        var homepage = "{{url_for('homepage')}}";

        function move(endpoint) { window.location.href = endpoint; }
    </script>
</head>
<body>
    <h1>Bug Lookup</h1>
    <hr class="long-line">

    <button onclick="move(homepage)">Back to Home</button>
    <br><br>
    
    <form id="searchForm" action="/search_bug" method="POST">
        <label for="search_options">Search by:</label>
        <select id="search_options">
            <option value="ALL" selected>All reports</option>
            <option value="bug_id">Bug ID</option>
            <option value="program_name">Program Name</option>
            <option value="report_type">Report Type</option>
            <option value="severity">Severity</option>
            <option value="reporter_name">Reporter ID</option>
            <option value="date">Date (mm-dd-yyyy)</option>
        </select>
        <button type="submit">Search</button>
        <br>
        <input type="search" id="searchInput" placeholder="enter search term by (search type)..." size="36"><br>
    </form>

    <hr>

    
    <table id="searchResults" class="fixedSize">
        <thead class="fixedHeader">
            <th scope="col" style="width: 17%" class="overflow pwd rev">Report ID</th>
            <th scope="col" style="width: 17%" class="overflow pwd">Date</th>
            <th scope="col" style="width: 50%" class="overflow pwd rev">Report Summary</th>
            <th scope="col" style="width: 17%">Operations</th>
        </thead>

        {% for result in results %}
        <tr>
            <td>{{ result['bug_id'] }}</td>
            <td class="overflow pwd">{{ result['bug_find_date'] }}</td>
            
            <!-- modal to view report, and related options -->
            <td class="overflow pwd">
                <a href="/view_report/{{result['bug_id']}}" data-toggle="modal" data-target="#modaledit{{result['bug_id']}}">{{ result['bug_title'] }}</a>
            </td>
            <td class="overflow pwd">
                <a href="plus_res/{{result['bug_id'] }}" data-toggle="modal" data-target="#modalres{{result['bug_id']}}" class="overflow pwd">+Res</a> |
                <a href="/delete/{{ result['bug_id'] }}" onclick="return confirm('Confirm deletion of bug report?')" class="overflow pwd rev">Delete</a>
            </td>
        </tr>

        <div id="#modaledit{{result['bug_id']}}" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Bug Report # {{ result['bug_id'] }}</h3>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <form id="editBugForm{{result['bug_id']}}" action="/edit_bug/{{result['bug_id']}}" method="POST">
                        
                    </form>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" form="editBugForm{{result['bug_id']}}">Make report changes</button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>


        {% endfor %}

    </table>

    {% if not results %}
        {% include 'no_results.html' %}
    {% endif %}
    
    <br>

</body>
</html>